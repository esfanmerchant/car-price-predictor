<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="icon" type="image/png" sizes="48x48" href="{{ url_for('static', filename='css/favicon6.png') }}">
    <title>AutoValuate Pro - Vehicle Valuation Platform</title>
    <style>
      :root {
        --primary: #3b82f6;
        --primary-dark: #1d4ed8;
        --primary-light: #dbeafe;
        --accent: #06b6d4;
        --accent-light: #e0f7fa;
        --success: #10b981;
        --success-light: #d1fae5;
        --warning: #f59e0b;
        --warning-light: #fef3c7;
        --error: #ef4444;
        --error-light: #fee2e2;
        --gray-50: #f8fafc;
        --gray-100: #f1f5f9;
        --gray-200: #e2e8f0;
        --gray-300: #cbd5e1;
        --gray-400: #94a3b8;
        --gray-500: #64748b;
        --gray-600: #475569;
        --gray-700: #334155;
        --gray-800: #1e293b;
        --gray-900: #0f172a;
        --white: #ffffff;
        --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
        --border-radius: 12px;
        --border-radius-lg: 16px;
        --border-radius-xl: 20px;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        --gradient-accent: linear-gradient(135deg, var(--accent) 0%, var(--primary) 100%);
        --gradient-bg: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: var(--gradient-bg);
        color: var(--gray-900);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        min-height: 100vh;
        padding: 24px;
        position: relative;
        overflow-x: hidden;
      }

      /* Subtle background pattern */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
          radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.05) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(6, 182, 212, 0.05) 0%, transparent 50%);
        pointer-events: none;
        z-index: 0;
      }

      .theme-toggle {
        position: fixed;
        top: 32px;
        right: 32px;
        background: var(--white);
        border: 1px solid var(--gray-200);
        border-radius: var(--border-radius);
        padding: 12px 20px;
        color: var(--gray-700);
        cursor: pointer;
        transition: var(--transition);
        font-weight: 600;
        font-size: 14px;
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: var(--shadow-lg);
        backdrop-filter: blur(10px);
      }

      .theme-toggle:hover {
        background: var(--gray-50);
        border-color: var(--primary);
        color: var(--primary);
        transform: translateY(-2px);
        box-shadow: var(--shadow-xl);
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: calc(100vh - 48px);
        position: relative;
        z-index: 1;
      }

      .main-card {
        background: var(--white);
        border-radius: var(--border-radius-xl);
        border: 1px solid var(--gray-200);
        box-shadow: var(--shadow-2xl);
        width: 100%;
        max-width: 1200px;
        overflow: hidden;
        position: relative;
        backdrop-filter: blur(10px);
      }

      .main-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        z-index: 1;
      }

      .card-header {
        background: var(--gradient-primary);
        padding: 64px 48px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .card-header::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        animation: float 6s ease-in-out infinite;
      }

      @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(180deg); }
      }

      .header-content {
        position: relative;
        z-index: 2;
      }

      .main-title {
        font-family: 'Space Grotesk', sans-serif;
        font-size: clamp(2.5rem, 5vw, 3.5rem);
        font-weight: 700;
        color: var(--white);
        margin: 0 0 16px 0;
        letter-spacing: -0.02em;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .main-title i {
        margin-right: 16px;
        opacity: 0.9;
        background: linear-gradient(45deg, rgba(255,255,255,1), rgba(255,255,255,0.8));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .subtitle {
        color: rgba(255, 255, 255, 0.9);
        font-size: 1.25rem;
        font-weight: 500;
        margin: 0;
        opacity: 0.95;
      }

      .stats-row {
        display: flex;
        justify-content: center;
        gap: 48px;
        margin-top: 32px;
        flex-wrap: wrap;
      }

      .stat-item {
        text-align: center;
        color: rgba(255, 255, 255, 0.9);
      }

      .stat-number {
        display: block;
        font-size: 2rem;
        font-weight: 700;
        color: var(--white);
        margin-bottom: 4px;
      }

      .stat-label {
        font-size: 0.875rem;
        opacity: 0.8;
        font-weight: 500;
      }

      .card-body {
        padding: 56px 48px;
        background: var(--white);
        position: relative;
      }

      .progress-indicator {
        display: flex;
        justify-content: center;
        margin-bottom: 48px;
        gap: 8px;
      }

      .progress-step {
        width: 120px;
        height: 4px;
        background: var(--gray-200);
        border-radius: 2px;
        position: relative;
        overflow: hidden;
      }

      .progress-step.active {
        background: var(--primary);
      }

      .progress-step.completed {
        background: var(--success);
      }

      .form-section {
        margin-bottom: 48px;
        position: relative;
      }

      .section-header {
        display: flex;
        align-items: center;
        margin-bottom: 32px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--gray-100);
      }

      .section-icon {
        width: 48px;
        height: 48px;
        background: var(--gradient-primary);
        border-radius: var(--border-radius);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-size: 20px;
        margin-right: 20px;
        box-shadow: var(--shadow-md);
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0;
        font-family: 'Space Grotesk', sans-serif;
      }

      .section-subtitle {
        color: var(--gray-600);
        font-size: 0.875rem;
        margin-top: 4px;
        font-weight: 500;
      }

      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 32px;
      }

      .form-group {
        position: relative;
        transition: var(--transition);
      }

      .form-group:hover {
        transform: translateY(-1px);
      }

      .form-group label {
        display: block;
        margin-bottom: 12px;
        font-weight: 600;
        color: var(--gray-800);
        font-size: 0.9rem;
        letter-spacing: 0.025em;
        text-transform: uppercase;
      }

      .form-group label i {
        margin-right: 8px;
        color: var(--primary);
        width: 18px;
        text-align: center;
        font-size: 1rem;
      }

      .input-wrapper {
        position: relative;
        transition: var(--transition);
      }

      .form-control {
        width: 100%;
        padding: 16px 20px;
        border: 2px solid var(--gray-200);
        border-radius: var(--border-radius);
        font-size: 16px;
        font-weight: 500;
        transition: var(--transition);
        background: var(--white);
        color: var(--gray-900);
        font-family: inherit;
        box-shadow: var(--shadow-sm);
      }

      .form-control:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px var(--primary-light), var(--shadow-md);
        transform: translateY(-1px);
      }

      .form-control:hover:not(:focus) {
        border-color: var(--gray-300);
        box-shadow: var(--shadow-md);
      }

      .form-control::placeholder {
        color: var(--gray-500);
        font-weight: 400;
      }

      select.form-control {
        cursor: pointer;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%233b82f6' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 16px center;
        background-repeat: no-repeat;
        background-size: 20px;
        padding-right: 48px;
        appearance: none;
      }

      select.form-control option {
        padding: 12px;
        background: var(--white);
        color: var(--gray-900);
        font-weight: 500;
      }

      .input-enhancement {
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray-400);
        font-size: 0.875rem;
        font-weight: 600;
        pointer-events: none;
        opacity: 0;
        transition: var(--transition);
      }

      .form-group:focus-within .input-enhancement {
        opacity: 1;
        color: var(--primary);
      }

      .predict-section {
        text-align: center;
        margin-top: 56px;
        padding: 40px;
        background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);
        border-radius: var(--border-radius-lg);
        border: 2px dashed var(--gray-200);
        position: relative;
        overflow: hidden;
      }

      .predict-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
        animation: shimmer 3s infinite;
      }

      @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
      }

      .btn-predict {
        background: var(--gradient-primary);
        border: none;
        border-radius: var(--border-radius);
        padding: 20px 48px;
        font-size: 18px;
        font-weight: 700;
        color: var(--white);
        cursor: pointer;
        transition: var(--transition);
        box-shadow: var(--shadow-lg);
        min-width: 280px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        position: relative;
        z-index: 1;
        text-transform: uppercase;
        letter-spacing: 0.025em;
        font-family: 'Space Grotesk', sans-serif;
      }

      .btn-predict::before {
        content: '';
        position: absolute;
        inset: 0;
        background: var(--gradient-accent);
        border-radius: inherit;
        opacity: 0;
        transition: var(--transition);
      }

      .btn-predict:hover::before {
        opacity: 1;
      }

      .btn-predict:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-2xl);
      }

      .btn-predict:active {
        transform: translateY(-1px);
      }

      .btn-predict:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none;
      }

      .btn-predict span,
      .btn-predict i {
        position: relative;
        z-index: 1;
      }

      .prediction-result {
        margin-top: 40px;
        padding: 32px;
        border-radius: var(--border-radius-lg);
        background: var(--white);
        border: 2px solid var(--gray-200);
        text-align: center;
        min-height: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: var(--transition);
        box-shadow: var(--shadow-sm);
        position: relative;
        overflow: hidden;
      }

      .prediction-result::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gray-300);
        transition: var(--transition);
      }

      .prediction-result.success {
        background: var(--success-light);
        border-color: var(--success);
        color: #065f46;
        box-shadow: var(--shadow-lg);
        transform: translateY(-2px);
      }

      .prediction-result.success::before {
        background: var(--success);
      }

      .prediction-result.error {
        background: var(--error-light);
        border-color: var(--error);
        color: #991b1b;
      }

      .prediction-result.error::before {
        background: var(--error);
      }

      .prediction-result.loading {
        background: var(--primary-light);
        border-color: var(--primary);
        color: var(--primary-dark);
      }

      .prediction-result.loading::before {
        background: var(--primary);
      }

      .prediction-result h3 {
        color: inherit;
        font-size: 1.5rem;
        font-weight: 700;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        font-family: 'Space Grotesk', sans-serif;
      }

      .loading-spinner {
        display: inline-block;
        width: 24px;
        height: 24px;
        border: 3px solid currentColor;
        border-radius: 50%;
        border-top-color: transparent;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      .price-highlight {
        font-size: 2rem;
        font-weight: 900;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Form validation states */
      .form-group.error .form-control {
        border-color: var(--error);
        box-shadow: 0 0 0 4px var(--error-light);
      }

      .form-group.success .form-control {
        border-color: var(--success);
        box-shadow: 0 0 0 4px var(--success-light);
      }

      .form-group.error .input-enhancement {
        color: var(--error);
        opacity: 1;
      }

      .form-group.success .input-enhancement {
        color: var(--success);
        opacity: 1;
      }

      /* Dark theme */
      body.dark {
        background: linear-gradient(135deg, var(--gray-900) 0%, #0c1222 100%);
        color: var(--gray-100);
      }

      body.dark::before {
        background: 
          radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
      }

      body.dark .theme-toggle {
        background: var(--gray-800);
        border-color: var(--gray-700);
        color: var(--gray-300);
      }

      body.dark .theme-toggle:hover {
        background: var(--gray-700);
        border-color: var(--primary);
        color: var(--primary);
      }

      body.dark .main-card {
        background: var(--gray-800);
        border-color: var(--gray-700);
      }

      body.dark .card-body {
        background: var(--gray-800);
      }

      body.dark .section-header {
        border-bottom-color: var(--gray-700);
      }

      body.dark .section-title {
        color: var(--gray-100);
      }

      body.dark .section-subtitle {
        color: var(--gray-400);
      }

      body.dark .form-group label {
        color: var(--gray-300);
      }

      body.dark .form-control {
        background: var(--gray-700);
        border-color: var(--gray-600);
        color: var(--gray-100);
      }

      body.dark .form-control:focus {
        border-color: var(--primary);
        background: var(--gray-700);
      }

      body.dark .form-control::placeholder {
        color: var(--gray-500);
      }

      body.dark .predict-section {
        background: linear-gradient(135deg, var(--gray-700) 0%, var(--gray-800) 100%);
        border-color: var(--gray-600);
      }

      body.dark .prediction-result {
        background: var(--gray-700);
        border-color: var(--gray-600);
        color: var(--gray-300);
      }

      body.dark .prediction-result.success {
        background: #022c22;
        border-color: var(--success);
        color: #10b981;
      }

      body.dark .prediction-result.error {
        background: #2d1b1b;
        border-color: var(--error);
        color: var(--error);
      }

      body.dark .prediction-result.loading {
        background: #1e3a8a;
        border-color: var(--primary);
        color: #60a5fa;
      }

      /* Responsive design */
      @media (max-width: 1024px) {
        .form-grid {
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: 24px;
        }

        .stats-row {
          gap: 32px;
        }
      }

      @media (max-width: 768px) {
        body {
          padding: 16px;
        }

        .container {
          min-height: calc(100vh - 32px);
        }

        .card-header {
          padding: 48px 32px;
        }

        .card-body {
          padding: 40px 32px;
        }

        .form-grid {
          grid-template-columns: 1fr;
          gap: 20px;
        }

        .theme-toggle {
          top: 20px;
          right: 20px;
          padding: 10px 16px;
          font-size: 13px;
        }

        .btn-predict {
          width: 100%;
          max-width: 320px;
          padding: 18px 32px;
        }

        .stats-row {
          gap: 24px;
          margin-top: 24px;
        }

        .stat-number {
          font-size: 1.5rem;
        }

        .progress-step {
          width: 80px;
        }
      }

      /* Micro-animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .form-section {
        animation: fadeInUp 0.6s ease-out;
      }

      .form-section:nth-child(2) { animation-delay: 0.1s; }
      .form-section:nth-child(3) { animation-delay: 0.2s; }
      .form-section:nth-child(4) { animation-delay: 0.3s; }

      .success-animation {
        animation: successPulse 1s ease-out;
      }

      @keyframes successPulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.02); }
        100% { transform: scale(1); }
      }
    </style>
  </head>
  <body>
    <button class="theme-toggle" onclick="toggleTheme()">
      <i class="fas fa-moon"></i>
      <span>Dark Mode</span>
    </button>
    
    <div class="container">
      <div class="main-card">
        <div class="card-header">
          <div class="header-content">
            <h1 class="main-title">
              <i class="fas fa-car-side"></i>
              AutoValuate Pro
            </h1>
            <p class="subtitle">AI-Powered Vehicle Valuation Platform</p>
            
            <div class="stats-row">
              <div class="stat-item">
                <span class="stat-number">99.2%</span>
                <span class="stat-label">Accuracy Rate</span>
              </div>
              <div class="stat-item">
                <span class="stat-number">50K+</span>
                <span class="stat-label">Valuations</span>
              </div>
              <div class="stat-item">
                <span class="stat-number">24/7</span>
                <span class="stat-label">Available</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="card-body">
          <div class="progress-indicator">
            <div class="progress-step active"></div>
            <div class="progress-step"></div>
            <div class="progress-step"></div>
          </div>

          <form method="post" action="#" accept-charset="utf-8">
            
            <div class="form-section">
              <div class="section-header">
                <div class="section-icon">
                  <i class="fas fa-car"></i>
                </div>
                <div>
                  <h2 class="section-title">Vehicle Information</h2>
                  <p class="section-subtitle">Basic details about your vehicle</p>
                </div>
              </div>
              <div class="form-grid">
                
                <div class="form-group">
                  <label for="brand">
                    <i class="fas fa-award"></i>
                    Brand
                  </label>
                  <div class="input-wrapper">
                    <select class="form-control" id="brand" name="brand" required onchange="handleCustomOption(this)">
                      <option value="">Select vehicle brand</option>
                      {% for type in brand %}
                      <option value="{{type}}">{{type}}</option>
                      {% endfor %}
                      <option value="Custom">Other Brand</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="year">
                    <i class="fas fa-calendar-alt"></i>
                    Manufacturing Year
                  </label>
                  <div class="input-wrapper">
                    <select class="form-control" id="year" name="year" required onchange="handleCustomOption(this)">
                      <option value="">Select year</option>
                      {% for type in year %}
                      <option value="{{type}}">{{type}}</option>
                      {% endfor %}
                      <option value="Custom">Other Year</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="seats">
                    <i class="fas fa-users"></i>
                    Seating Capacity
                  </label>
                  <div class="input-wrapper">
                    <select class="form-control" id="seats" name="seats" required onchange="handleCustomOption(this)">
                      <option value="">Select seating capacity</option>
                      <option value="1">1 Seat</option>
                      <option value="2">2 Seats</option>
                      <option value="3">3 Seats</option>
                      <option value="4">4 Seats</option>
                      <option value="5">5 Seats</option>
                      <option value="6">6 Seats</option>
                      <option value="7">7 Seats</option>
                      <option value="8">8 Seats</option>
                      <option value="9">9 Seats</option>
                      <option value="10">10+ Seats</option>
                      <option value="Custom">Custom</option>
                    </select>
                  </div>
                </div>

              </div>
            </div>

            <div class="form-section">
              <div class="section-header">
                <div class="section-icon">
                  <i class="fas fa-tachometer-alt"></i>
                </div>
                <div>
                  <h2 class="section-title">Performance & Usage</h2>
                  <p class="section-subtitle">Engine specifications and usage history</p>
                </div>
              </div>
              <div class="form-grid">

                <div class="form-group">
                  <label for="kilo_driven">
                    <i class="fas fa-route"></i>
                    Distance Traveled
                  </label>
                  <div class="input-wrapper">
                    <input class="form-control" type="text" id="kilo_driven" name="kilo_driven" placeholder="e.g., 45,000">
                    <span class="input-enhancement">KM</span>
                  </div>
                </div>

                <div class="form-group">
                  <label for="engine">
                    <i class="fas fa-cogs"></i>
                    Engine Capacity
                  </label>
                  <div class="input-wrapper">
                    <input class="form-control" type="text" id="engine" name="engine" placeholder="e.g., 1498">
                    <span class="input-enhancement">CC</span>
                  </div>
                </div>

                <div class="form-group">
                  <label for="power">
                    <i class="fas fa-bolt"></i>
                    Power Output
                  </label>
                  <div class="input-wrapper">
                    <input class="form-control" type="text" id="power" name="power" placeholder="e.g., 118">
                    <span class="input-enhancement">BHP</span>
                  </div>
                </div>

                <div class="form-group">
                  <label for="mileage">
                    <i class="fas fa-leaf"></i>
                    Fuel Efficiency
                  </label>
                  <div class="input-wrapper">
                    <input class="form-control" type="text" id="mileage" name="mileage" placeholder="e.g., 18.5">
                    <span class="input-enhancement">KM/L</span>
                  </div>
                </div>

              </div>
            </div>

            <div class="form-section">
              <div class="section-header">
                <div class="section-icon">
                  <i class="fas fa-info-circle"></i>
                </div>
                <div>
                  <h2 class="section-title">Additional Details</h2>
                  <p class="section-subtitle">Ownership and technical specifications</p>
                </div>
              </div>
              <div class="form-grid">

                <div class="form-group">
                  <label for="owner_type">
                    <i class="fas fa-user-tie"></i>
                    Owner Type
                  </label>
                  <div class="input-wrapper">
                    <select class="form-control" id="owner_type" name="owner_type" required>
                      <option value="">Select owner type</option>
                      {% for type in owner_type %}
                      <option value="{{type}}">{{type}} Owner</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="fuel_type">
                    <i class="fas fa-gas-pump"></i>
                    Fuel Type
                  </label>
                  <div class="input-wrapper">
                    <select class="form-control" id="fuel_type" name="fuel_type" required>
                      <option value="">Select fuel type</option>
                      {% for type in fuel_type %}
                      <option value="{{type}}">{{type}}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="tranmission">
                    <i class="fas fa-cog"></i>
                    Transmission
                  </label>
                  <div class="input-wrapper">
                    <select class="form-control" id="tranmission" name="tranmission" required>
                      <option value="">Select transmission type</option>
                      {% for type in tranmission %}
                      <option value="{{type}}">{{type}}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>

              </div>
            </div>

            <div class="predict-section">
              <button type="submit" class="btn-predict" onclick="send_data()">
                <i class="fas fa-brain"></i>
                <span>Calculate Market Value</span>
              </button>
              <p style="margin-top: 16px; color: var(--gray-600); font-size: 0.875rem; font-weight: 500;">
                Get instant AI-powered valuation based on current market trends
              </p>
            </div>

          </form>

          <div class="prediction-result" id="result-container">
            <h3><span id="prediction">
              <i class="fas fa-chart-line"></i>
              Ready to analyze your vehicle's market value
            </span></h3>
          </div>

        </div>
      </div>
    </div>

    <script>
    let currentStep = 1;
    const totalSteps = 3;

    // Update progress indicator
    function updateProgress() {
      const steps = document.querySelectorAll('.progress-step');
      steps.forEach((step, index) => {
        step.classList.remove('active', 'completed');
        if (index < currentStep - 1) {
          step.classList.add('completed');
        } else if (index === currentStep - 1) {
          step.classList.add('active');
        }
      });
    }

    // Form validation and progress tracking
    function validateSection(sectionIndex) {
      const sections = document.querySelectorAll('.form-section');
      const section = sections[sectionIndex];
      const requiredFields = section.querySelectorAll('[required]');
      let isValid = true;

      requiredFields.forEach(field => {
        if (!field.value.trim()) {
          isValid = false;
        }
      });

      if (isValid && currentStep <= sectionIndex + 1) {
        currentStep = Math.min(sectionIndex + 2, totalSteps);
        updateProgress();
      }
    }

    // Enhanced form interactions
    document.querySelectorAll('.form-control').forEach((input, index) => {
      input.addEventListener('blur', () => {
        validateField(input);
        
        // Determine which section this field belongs to
        const section = input.closest('.form-section');
        const sectionIndex = Array.from(document.querySelectorAll('.form-section')).indexOf(section);
        validateSection(sectionIndex);
      });

      input.addEventListener('input', () => {
        clearValidation(input);
        
        // Add typing animation
        const formGroup = input.closest('.form-group');
        formGroup.style.transform = 'translateY(-1px)';
        setTimeout(() => {
          formGroup.style.transform = 'translateY(0)';
        }, 150);
      });

      // Stagger form field animations
      input.closest('.form-group').style.animationDelay = $;{index * 0.1}s;
    });

    function handleCustomOption(select){
      if (select.value === "Custom"){
        const originalSelect = select.cloneNode(true);
        const inputWrapper = select.closest('.input-wrapper');

        const input = document.createElement("input");
        input.type = "text";
        input.name = select.name;
        input.id = select.id;
        input.className = select.className; 
        input.placeholder = "Enter custom value";
        input.style.animation = 'fadeInUp 0.3s ease-out';
        
        input._originalSelect = originalSelect;

        inputWrapper.replaceChild(input, select);

        // Focus with smooth animation
        setTimeout(() => {
          input.focus();
          input.style.borderColor = 'var(--primary)';
          input.style.boxShadow = '0 0 0 4px var(--primary-light)';
        }, 100);

        input.addEventListener("blur", function () {
          if (input.value.trim() === "") {
            restoreDropdown(input);
          } else {
            validateField(input);
          }
        });

        input.addEventListener("keydown", function (e) {
          if (e.key === "Escape") {
            restoreDropdown(input);
          }
          if (e.key === "Enter") {
            input.blur();
          }
        });
      }
    }

    function restoreDropdown(input){
      const originalSelect = input._originalSelect;
      if (!originalSelect) return;

      originalSelect.setAttribute("onchange", "handleCustomOption(this)");
      originalSelect.style.animation = 'fadeInUp 0.3s ease-out';
      
      const inputWrapper = input.closest('.input-wrapper');
      inputWrapper.replaceChild(originalSelect, input);
    }

    function form_handler(event){
      event.preventDefault();
    }

    function validateField(field) {
      const formGroup = field.closest('.form-group');
      
      if (field.hasAttribute('required') && !field.value.trim()) {
        formGroup.classList.add('error');
        formGroup.classList.remove('success');
      } else if (field.value.trim()) {
        formGroup.classList.add('success');
        formGroup.classList.remove('error');
        
        // Add micro success animation
        formGroup.style.transform = 'scale(1.01)';
        setTimeout(() => {
          formGroup.style.transform = 'scale(1)';
        }, 200);
      }
    }

    function clearValidation(field) {
      const formGroup = field.closest('.form-group');
      formGroup.classList.remove('error', 'success');
    }

    function send_data() {
      document.querySelector("form").addEventListener("submit", form_handler);

      const fd = new FormData(document.querySelector("form"));
      const xhr = new XMLHttpRequest({ mozSystem: true });
      const predictionElement = document.getElementById("prediction");
      const resultContainer = document.getElementById("result-container");
      const submitBtn = document.querySelector(".btn-predict");

      // Enhanced loading state
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<span class="loading-spinner"></span><span>Processing Data...</span>';
      
      resultContainer.className = 'prediction-result loading';
      predictionElement.innerHTML = `
        <span class="loading-spinner"></span>
        Analyzing vehicle data with AI algorithms...
      `;

      // Update progress to final step
      currentStep = totalSteps;
      updateProgress();

      xhr.open("POST", "/predict", true);

      xhr.onreadystatechange = function () {
        if (xhr.readyState === XMLHttpRequest.DONE) {
          submitBtn.disabled = false;
          submitBtn.innerHTML = '<i class="fas fa-brain"></i><span>Calculate Market Value</span>';
          
          if (xhr.status === 200) {
            // Enhanced success case
            resultContainer.className = 'prediction-result success success-animation';
            predictionElement.innerHTML = `
              <i class="fas fa-check-circle"></i>
              <div>
                <span style="display: block; font-size: 1rem; font-weight: 500; margin-bottom: 4px;">Estimated Market Value</span>
                <span class="price-highlight">PKR ${xhr.responseText} Lacs</span>
              </div>
            `;

            // Confetti-like effect simulation
            setTimeout(() => {
              resultContainer.style.transform = 'scale(1.02)';
              setTimeout(() => {
                resultContainer.style.transform = 'scale(1)';
              }, 300);
            }, 100);
            
          } else {
            // Enhanced error case
            resultContainer.className = 'prediction-result error';
            predictionElement.innerHTML = `
              <i class="fas fa-exclamation-triangle"></i>
              <div>
                <span style="display: block; font-size: 1rem; font-weight: 600;">Validation Error</span>
                <span style="font-size: 0.875rem; opacity: 0.8;">Please verify all fields and try again</span>
              </div>
            `;
          }
        }
      };

      xhr.send(fd);
    }

    function toggleTheme() {
      document.body.classList.toggle("dark");
      const btn = document.querySelector(".theme-toggle");
      const icon = btn.querySelector("i");
      const text = btn.querySelector("span");
      
      if (document.body.classList.contains("dark")) {
        icon.className = "fas fa-sun";
        text.textContent = "Light Mode";
      } else {
        icon.className = "fas fa-moon";
        text.textContent = "Dark Mode";
      }

      // Smooth theme transition animation
      btn.style.transform = 'scale(0.95)';
      setTimeout(() => {
        btn.style.transform = 'scale(1)';
      }, 150);
    }

    // Initialize progress indicator
    updateProgress();

    // Add smooth scroll for better mobile experience
    function smoothScrollToElement(element) {
      element.scrollIntoView({
        behavior: 'smooth',
        block: 'center'
      });
    }

    // Focus management for better accessibility
    document.querySelectorAll('.form-control').forEach(input => {
      input.addEventListener('focus', () => {
        if (window.innerWidth <= 768) {
          setTimeout(() => smoothScrollToElement(input), 300);
        }
      });
    });

    // Add real-time form validation feedback
    document.querySelector('form').addEventListener('input', () => {
      const requiredFields = document.querySelectorAll('[required]');
      let filledFields = 0;
      
      requiredFields.forEach(field => {
        if (field.value.trim()) filledFields++;
      });
      
      const completion = Math.round((filledFields / requiredFields.length) * 100);
      
      // Could add a completion indicator here
      if (completion === 100) {
        document.querySelector('.btn-predict').style.background = 'var(--gradient-accent)';
      } else {
        document.querySelector('.btn-predict').style.background = 'var(--gradient-primary)';
      }
    });

    // Add keyboard shortcuts for power users
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'Enter') {
        e.preventDefault();
        document.querySelector('.btn-predict').click();
      }
    });
    </script>
  </body>
</html>